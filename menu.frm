VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.MDIForm menu 
   BackColor       =   &H8000000C&
   Caption         =   "Jardín Artístico La Escuelita"
   ClientHeight    =   8190
   ClientLeft      =   165
   ClientTop       =   255
   ClientWidth     =   11880
   Icon            =   "menu.frx":0000
   LinkTopic       =   "MDIForm1"
   Moveable        =   0   'False
   Picture         =   "menu.frx":1942
   StartUpPosition =   2  'CenterScreen
   WindowState     =   2  'Maximized
   Begin VB.PictureBox imagenes 
      Align           =   1  'Align Top
      Height          =   1455
      Left            =   0
      ScaleHeight     =   1395
      ScaleWidth      =   11820
      TabIndex        =   1
      Top             =   0
      Visible         =   0   'False
      Width           =   11880
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   19
         Left            =   4800
         Picture         =   "menu.frx":15C1EE
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   19
         Top             =   1080
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   18
         Left            =   4800
         Picture         =   "menu.frx":15C730
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   18
         Top             =   720
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   17
         Left            =   4800
         Picture         =   "menu.frx":15CC72
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   17
         Top             =   360
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   16
         Left            =   4800
         Picture         =   "menu.frx":15D1B4
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   16
         Top             =   0
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   15
         Left            =   4200
         Picture         =   "menu.frx":15D2B6
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   15
         Top             =   360
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   14
         Left            =   4200
         Picture         =   "menu.frx":15D3B8
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   14
         Top             =   0
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   13
         Left            =   3840
         Picture         =   "menu.frx":15D4BA
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   13
         Top             =   1080
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   12
         Left            =   3840
         Picture         =   "menu.frx":15D5BC
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   12
         Top             =   720
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   11
         Left            =   3840
         Picture         =   "menu.frx":15DAFE
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   11
         Top             =   360
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   10
         Left            =   3840
         Picture         =   "menu.frx":15E040
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   10
         Top             =   0
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   9
         Left            =   3120
         Picture         =   "menu.frx":15E382
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   9
         Top             =   0
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   8
         Left            =   1920
         Picture         =   "menu.frx":15E484
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   8
         Top             =   720
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   7
         Left            =   1920
         Picture         =   "menu.frx":15E9C6
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   7
         Top             =   360
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   6
         Left            =   1920
         Picture         =   "menu.frx":15EAC8
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   6
         Top             =   0
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   3
         Left            =   960
         Picture         =   "menu.frx":15EBCA
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   5
         Top             =   0
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   2
         Left            =   120
         Picture         =   "menu.frx":15EF0C
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   4
         Top             =   360
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   1
         Left            =   120
         Picture         =   "menu.frx":15F00E
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   3
         Top             =   0
         Width           =   300
      End
      Begin VB.PictureBox Picture1 
         AutoRedraw      =   -1  'True
         AutoSize        =   -1  'True
         Height          =   300
         Index           =   0
         Left            =   120
         Picture         =   "menu.frx":15F550
         ScaleHeight     =   240
         ScaleWidth      =   240
         TabIndex        =   2
         Top             =   720
         Width           =   300
      End
   End
   Begin MSComctlLib.StatusBar estado 
      Align           =   2  'Align Bottom
      Height          =   255
      Left            =   0
      TabIndex        =   0
      Top             =   7935
      Width           =   11880
      _ExtentX        =   20955
      _ExtentY        =   450
      _Version        =   393216
      BeginProperty Panels {8E3867A5-8586-11D1-B16A-00C0F0283628} 
         NumPanels       =   4
         BeginProperty Panel1 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   2
            Object.ToolTipText     =   "Usuario Actual"
         EndProperty
         BeginProperty Panel2 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   6
            TextSave        =   "04/08/2004"
            Object.ToolTipText     =   "Fecha del Sistema"
         EndProperty
         BeginProperty Panel3 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   5
            AutoSize        =   2
            TextSave        =   "11:26"
            Object.ToolTipText     =   "Hora del Sistema"
         EndProperty
         BeginProperty Panel4 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   1
            Object.Width           =   12726
            Object.ToolTipText     =   "Estado Actual"
         EndProperty
      EndProperty
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSComctlLib.ImageList lista 
      Left            =   120
      Top             =   1320
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   24
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":15FA92
            Key             =   "nuevo"
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":15FEE4
            Key             =   "lapis"
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":160336
            Key             =   "acercade"
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":160788
            Key             =   "repor1"
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":160BDA
            Key             =   "repor2"
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":16102C
            Key             =   "repor3"
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":16147E
            Key             =   "repor4"
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":1618D0
            Key             =   "repor5"
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":161BEA
            Key             =   "nuevo6"
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":16203E
            Key             =   "consulta"
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":162492
            Key             =   "consulta1"
         EndProperty
         BeginProperty ListImage12 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":1628E6
            Key             =   "consulta2"
         EndProperty
         BeginProperty ListImage13 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":162D3A
            Key             =   "nuevo5"
         EndProperty
         BeginProperty ListImage14 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":163192
            Key             =   "salir"
         EndProperty
         BeginProperty ListImage15 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":1635E6
            Key             =   "nuevo1"
         EndProperty
         BeginProperty ListImage16 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":163A3A
            Key             =   "nuevo2"
         EndProperty
         BeginProperty ListImage17 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":163E8E
            Key             =   "nuevo3"
         EndProperty
         BeginProperty ListImage18 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":1642E2
            Key             =   "backup"
         EndProperty
         BeginProperty ListImage19 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":164BBC
            Key             =   "restaurar"
         EndProperty
         BeginProperty ListImage20 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":164ED6
            Key             =   "busqueda"
         EndProperty
         BeginProperty ListImage21 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":166BE0
            Key             =   "ayuda"
         EndProperty
         BeginProperty ListImage22 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":169A6A
            Key             =   "user"
         EndProperty
         BeginProperty ListImage23 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":16FD04
            Key             =   "certi"
         EndProperty
         BeginProperty ListImage24 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "menu.frx":171A0E
            Key             =   "carnet"
         EndProperty
      EndProperty
   End
   Begin VB.Menu ing 
      Caption         =   "&Ingresos"
      Begin VB.Menu estudiantes 
         Caption         =   "&Estudiantes"
         Begin VB.Menu listadoespera 
            Caption         =   "&Listado de Espera"
            Shortcut        =   ^L
         End
         Begin VB.Menu inscripcion 
            Caption         =   "I&nscripciones"
            Shortcut        =   ^I
         End
         Begin VB.Menu matriculass 
            Caption         =   "&Matriculas"
            Shortcut        =   ^M
         End
      End
      Begin VB.Menu empleadoss 
         Caption         =   "E&mpleados"
         Shortcut        =   ^E
      End
      Begin VB.Menu se 
         Caption         =   "-"
      End
      Begin VB.Menu exit 
         Caption         =   "&Salir"
         Shortcut        =   ^S
      End
   End
   Begin VB.Menu pagosss 
      Caption         =   "&Pagos"
      Begin VB.Menu pmat 
         Caption         =   "&Matricula"
         Shortcut        =   ^Q
      End
      Begin VB.Menu ppension 
         Caption         =   "&Pensión"
         Shortcut        =   ^P
      End
      Begin VB.Menu potro 
         Caption         =   "&Otros"
         Shortcut        =   ^O
      End
   End
   Begin VB.Menu md 
      Caption         =   "Material &Didáctico"
      Begin VB.Menu mex 
         Caption         =   "Ma&terial Existente"
         Shortcut        =   ^T
      End
      Begin VB.Menu mdes 
         Caption         =   "Mat&erial Despachado"
         Shortcut        =   ^D
      End
      Begin VB.Menu com 
         Caption         =   "&Compras"
         Shortcut        =   ^C
      End
   End
   Begin VB.Menu report 
      Caption         =   "&Reportes"
      Begin VB.Menu genreport 
         Caption         =   "&Generador de Reportes"
         Shortcut        =   ^G
      End
   End
   Begin VB.Menu opcion 
      Caption         =   "&Opciones"
      Begin VB.Menu confiuser 
         Caption         =   "Configuración de &Usuarios"
         Shortcut        =   ^U
      End
      Begin VB.Menu ingsis 
         Caption         =   "Ingresos al &Sistema"
         Shortcut        =   ^N
      End
      Begin VB.Menu ingpara 
         Caption         =   "Ingreso &de Parámetros"
         Shortcut        =   ^R
      End
      Begin VB.Menu s1 
         Caption         =   "-"
      End
      Begin VB.Menu certi 
         Caption         =   "Certi&ficados, Diplomas, Constancias..."
         Shortcut        =   ^F
      End
      Begin VB.Menu s2 
         Caption         =   "-"
      End
      Begin VB.Menu bak 
         Caption         =   "Backup &Base de Datos"
         Shortcut        =   ^B
      End
      Begin VB.Menu restaurar 
         Caption         =   "Restaurar Base de &Datos"
         Shortcut        =   ^A
      End
   End
   Begin VB.Menu help 
      Caption         =   "?"
      Begin VB.Menu ayu 
         Caption         =   "&Ayuda"
         Shortcut        =   {F1}
      End
      Begin VB.Menu indice 
         Caption         =   "&Indice"
      End
      Begin VB.Menu bus 
         Caption         =   "&Búsqueda"
      End
      Begin VB.Menu s3 
         Caption         =   "-"
      End
      Begin VB.Menu acerca 
         Caption         =   "Acer&ca de..."
      End
   End
End
Attribute VB_Name = "menu"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
#If Win32 Then
Private Declare Function GetSystemMenu Lib "user32" _
    (ByVal hWnd As Long, ByVal bRevert As Long) As Long
Private Declare Function DeleteMenu Lib "user32" _
    (ByVal hMenu As Long, ByVal nPosition As Long, _
    ByVal wFlags As Long) As Long
#End If

'constantes a utilizar para inhabilitar los comandos
Const SC_SIZE = &HF000
Const SC_MOVE = &HF010
Const SC_MINIMIZE = &HF020
Const SC_MAXIMIZE = &HF030
Const SC_CLOSE = &HF060
Const SC_RESTORE = &HF120
Const MF_SEPARATOR = &H800
Const MF_BYPOSITION = &H400
Const MF_BYCOMMAND = &H0

Private Sub listados_Click()
Form1.Show
End Sub


Private Sub acerca_Click()
acercade.Show
End Sub

Private Sub ayu_Click()
chmHelp.DisplayTOC
        chmHelp.DisplayTopic "index.htm"
        DoEvents
End Sub

Private Sub bak_Click()
If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            BackupR = True
            backup.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
End Sub

Private Sub bus_Click()
chmHelp.DisplaySearch
        DoEvents
End Sub

Private Sub certi_Click()
certificados.Show
End Sub

Private Sub com_Click()
If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Compras.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
End Sub

Private Sub confiuser_Click()
menu.Enabled = False
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Perfiles.Show
End Sub

Private Sub empleado_Click()

End Sub

Private Sub empleadoss_Click()
If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        empleado.Show
End Sub

Private Sub exit_Click()
Unload Me
End Sub

Private Sub genreport_Click()
If FormularioActivo = True Then
        Unload menu.ActiveForm
    End If
    reportes.WindowState = 2
    reportes.Show
End Sub

Private Sub indice_Click()
 chmHelp.DisplayIndex
        DoEvents
End Sub

Private Sub ingpara_Click()
If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        ingresos.Show
End Sub

Private Sub ingsis_Click()
If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Bitacora.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
End Sub

Private Sub inscripcion_Click()
If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        inscripciones.Show
End Sub

Private Sub listadoespera_Click()
If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        listespera.Show
End Sub

Private Sub matricula_Click()

End Sub

Private Sub matriculass_Click()
If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        matricula.Show
End Sub

Private Sub mdes_Click()
If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            mdespachado.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
End Sub

Private Sub MDIForm_Initialize()
InitCommonControls
End Sub

Private Sub MDIForm_Load()
chmHelp.HelpFile = App.Path + "\jardin.chm"
estado.Panels(4).Text = "Menú Principal"
estado.Panels(1).Text = "Usuario: " & usuario

'coloca las imagenes o iconos en los menus
'SE CARGAN LAS VARIABLES
Dim hMenu As Long, hSubMenu As Long

'MENU INGRESOS
hMenu = GetMenu(Me.hWnd)
hSubMenu = GetSubMenu(hMenu, 0)
SetMenuItemBitmaps hSubMenu, 0, MF_BYPOSITION, Picture1(1).Picture, Picture1(1).Picture
SetMenuItemBitmaps hSubMenu, 1, MF_BYPOSITION, Picture1(2).Picture, Picture1(2).Picture
SetMenuItemBitmaps hSubMenu, 3, MF_BYPOSITION, Picture1(0).Picture, Picture1(0).Picture

'MENU PAGOS
hMenu = GetMenu(Me.hWnd)
hSubMenu = GetSubMenu(hMenu, 1)
SetMenuItemBitmaps hSubMenu, 0, MF_BYPOSITION, Picture1(3).Picture, Picture1(3).Picture
SetMenuItemBitmaps hSubMenu, 1, MF_BYPOSITION, Picture1(3).Picture, Picture1(3).Picture
SetMenuItemBitmaps hSubMenu, 2, MF_BYPOSITION, Picture1(3).Picture, Picture1(3).Picture

'MENU MATERIAL DIDACTICO
hMenu = GetMenu(Me.hWnd)
hSubMenu = GetSubMenu(hMenu, 2)
SetMenuItemBitmaps hSubMenu, 0, MF_BYPOSITION, Picture1(6).Picture, Picture1(6).Picture
SetMenuItemBitmaps hSubMenu, 1, MF_BYPOSITION, Picture1(7).Picture, Picture1(7).Picture
SetMenuItemBitmaps hSubMenu, 2, MF_BYPOSITION, Picture1(8).Picture, Picture1(8).Picture

'MENU REPORTES
hMenu = GetMenu(Me.hWnd)
hSubMenu = GetSubMenu(hMenu, 3)
SetMenuItemBitmaps hSubMenu, 0, MF_BYPOSITION, Picture1(9).Picture, Picture1(9).Picture

'MENU OPCIONES
hMenu = GetMenu(Me.hWnd)
hSubMenu = GetSubMenu(hMenu, 4)
SetMenuItemBitmaps hSubMenu, 0, MF_BYPOSITION, Picture1(10).Picture, Picture1(10).Picture
SetMenuItemBitmaps hSubMenu, 1, MF_BYPOSITION, Picture1(11).Picture, Picture1(11).Picture
SetMenuItemBitmaps hSubMenu, 2, MF_BYPOSITION, Picture1(12).Picture, Picture1(12).Picture
SetMenuItemBitmaps hSubMenu, 4, MF_BYPOSITION, Picture1(13).Picture, Picture1(13).Picture
SetMenuItemBitmaps hSubMenu, 6, MF_BYPOSITION, Picture1(14).Picture, Picture1(14).Picture
SetMenuItemBitmaps hSubMenu, 7, MF_BYPOSITION, Picture1(15).Picture, Picture1(15).Picture

'MENU ?
hMenu = GetMenu(Me.hWnd)
hSubMenu = GetSubMenu(hMenu, 5)
SetMenuItemBitmaps hSubMenu, 0, MF_BYPOSITION, Picture1(16).Picture, Picture1(16).Picture
SetMenuItemBitmaps hSubMenu, 1, MF_BYPOSITION, Picture1(17).Picture, Picture1(17).Picture
SetMenuItemBitmaps hSubMenu, 2, MF_BYPOSITION, Picture1(18).Picture, Picture1(18).Picture
SetMenuItemBitmaps hSubMenu, 4, MF_BYPOSITION, Picture1(19).Picture, Picture1(19).Picture



End Sub


Private Sub MDIForm_QueryUnload(Cancel As Integer, UnloadMode As Integer)
On Error Resume Next
If MsgBox("Desea salir del programa?", vbQuestion + vbYesNo, "Salir de SISJACE") = vbYes Then
    Unload menu
Else
    Cancel = True
End If
End Sub

Private Sub MDIForm_Resize()
If menu.WindowState <> 1 Then
    menu.WindowState = 2
End If
End Sub

Private Sub MDIForm_Unload(Cancel As Integer)
On Error Resume Next
Unload SmartMenuXP1
Unload menu
End
End Sub

Private Sub mex_Click()
If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        material.Show
End Sub

Private Sub pmat_Click()
If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Pagos.xpgroupbox1.Caption = "Matricula"
            Pagos.Tag = "Matricula"
            PagoActual = 0
            Pagos.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
End Sub

Private Sub potro_Click()
If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Pagos.xpgroupbox1.Caption = "Otros"
            Pagos.Tag = "Otros"
            PagoActual = 2
            Pagos.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
End Sub

Private Sub ppension_Click()
If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Pagos.xpgroupbox1.Caption = "Pensión"
            Pagos.Tag = "Pensión"
            PagoActual = 1
            Pagos.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
End Sub

Private Sub restaurar_Click()
If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            BackupR = False
            backup.Label2 = "Origen"
            backup.Label1 = "Se va a realizar una restauración de la Base de Datos."
            backup.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
End Sub

Private Sub SmartMenuXP1_Click(ByVal ID As Long)
With SmartMenuXP1.MenuItems
  Select Case .Key(ID)
    Case "salir"
        Unload Me
    Case "listadodeespera":
        If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        listespera.Show
    Case "inscripcionesF":
        If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        inscripciones.Show
    Case "matricula":
        If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        matricula.Show
    Case "empleados":
        If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        empleado.Show
        'pagos
    Case "matriculas":
        If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Pagos.xpgroupbox1.Caption = "Matricula"
            Pagos.Tag = "Matricula"
            PagoActual = 0
            Pagos.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
       
    Case "pensiones":
        If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Pagos.xpgroupbox1.Caption = "Pensión"
            Pagos.Tag = "Pensión"
            PagoActual = 1
            Pagos.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
       
    Case "otros":
       If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Pagos.xpgroupbox1.Caption = "Otros"
            Pagos.Tag = "Otros"
            PagoActual = 2
            Pagos.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
    Case "materialdespachado":
        If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            mdespachado.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
    Case "material":
        If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        material.Show
    Case "compras"
        If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Compras.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
    '-------
    
    'REPORTES
    Case "generar":
    If FormularioActivo = True Then
        Unload menu.ActiveForm
    End If
    reportes.WindowState = 2
    reportes.Show
    
    Case "confiusers":
            menu.Enabled = False
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Perfiles.Show
        
    'CERTIFICADOS
    Case "varios":
        certificados.Show
    Case "backup":
        If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            BackupR = True
            backup.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
    Case "restaurar":
        If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            BackupR = False
            backup.Label2 = "Origen"
            backup.Label1 = "Se va a realizar una restauración de la Base de Datos."
            backup.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
    Case "ayuda":
        chmHelp.DisplayTOC
        chmHelp.DisplayTopic "index.htm"
        DoEvents
    Case "busqueda":
        chmHelp.DisplaySearch
        DoEvents
    Case "indice":
        chmHelp.DisplayIndex
        DoEvents
    Case "bita":
       If perfil = 1 Then
            If FormularioActivo = True Then
                Unload menu.ActiveForm
            End If
            Bitacora.Show
        Else
            MsgBox usuario & ". No tiene permisos para realizar esta operación!", vbInformation, "Permisos de Usuario"
            Exit Sub
        End If
    Case "acerca": acercade.Show
    'ingresos a los combos
    Case "ingcombo":
        If FormularioActivo = True Then
            Unload menu.ActiveForm
        End If
        ingresos.Show
End Select
End With
End Sub
